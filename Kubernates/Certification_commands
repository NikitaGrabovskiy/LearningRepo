
        *** Docker D  commands ***

        You can use the same commands as docker but use *    nerdctl    * instead :

        $ docker
        $ docker run --name redis redis:alpine
        $ docker run --name webserver -p 80:80 -d nginx

            Same thing :
        $ nerdctl
        $ nerdctl run --name redis redis:alpine
        $ nerdctl run --name webserver -p 80:80 -d nginx


        *** Debug containers using crictl - can be used for any container technology ***

$ crictl
$ crictl pull busybox
$ crictl images
$ crictl ps -a
$ crictl exec -i -t 3e025dd50a72d956c4f14881fbb5b1080c9275674e95fb67f965f6478a957d60 ls
$ crictl logs 3e025dd50a72d956c4f1
$ crictl pods (You can also see pods)

        *** etcd commands ***

 ./etcdctl put key1 value1              - put value
 ./etcdctl get key1                     - get value


if installed with kubeadm - you can see it by running :

kubectl get pods -n kube-system

(You'll see etcd-master pod)

if installed with kubeadm use the command to see all the values stored in the etcd:

kubectl exec etcd-master -n kube-system etcdctl get/ --prefix -keys-only

    ******

ps -aux | grep kube-apiserver   - use to see all the available configurations of kube-apiserver

    ******

ps -aux | grep kube-controller-manager    - to see all kube controller configs

    ******

Viewing kube-scheduler Options (If installed with kubeadm)

cat /etc/kubernates/manifests/kube-scheduler.yaml

ps -aux | grep kube-scheduler - another way to see configs

    ******

 ps -aux | grep kubelet (Needs to be run on worker node to see configs of kubelet)

    ******

kubectl run <Image_name> --image nginx

kubectl describe pod <Name>

kubectl apply -f pod.yaml

    *******
                Use to change number or replicas. (Two ways - using file and using replicaSetNmae)

kubectl scale --replicas=6 <definition_file_name>.yaml

kubectl scale --replicas-6 replicaset <REPLICA_SET_NAME>

            Replace:

kubectl replace -f <FILE_NAME>.yaml

                                        ******

kubectl get all         (To get all objects)

                                        ******
kubectl run nginx --image=nginx --dry-run=client -o yaml            (Generate a yaml file but do not run it)

                                        ******

(You can create a deployment by just specifying image)
kubectl create deployment --image=nginx nginx

                To create a yaml file for the deployment

kubectl create deployment --image=nginx nginx --dry-run=client -o yaml > nginx-deployment.yaml

                                        ******

--help
to get help options (make sure it has 2 --)

                                        ******
                            Set default namespace
kubectl config set-context --current --namespace=<namespace-name>

                                        ******
                    Option to see in all namespaces
-A

 --all-namespaces

                                         ******
You can run apply command not just for one object but for the whole package:

kubectl apply -f /path/files
                                         ******

--dry-run: By default as soon as the command is run, the resource will be created.
If you simply want to test your command , use the --dry-run=client option. This will not create the resource,
 instead, tell you whether the resource can be created and if your command is right.

-o yaml: This will output the resource definition in YAML format on screen.

kubectl scale deployment nginx --replicas=4

Another way to do this is to save the YAML definition to a file and modify
kubectl create deployment nginx --image=nginx --dry-run=client -o yaml > nginx-deployment.yaml


                                          *****
List all possible resources - if for example forget resource name:

    kubectl api-resources

After you find resource you can do that to get more info

    kubectl explain pod --recursive

    or to get even more info on spec do

    kubectl explain service.spec


                                        ****

                 REMEMBER ! When you do created - you do not specify resource type you just do:

                 kubectl create -f filename.yaml         (no create pod, or create service)

                                        ****

     When you create a service with imperative commands you have to specify a type
kubectl create svc <type> <name> [flags]

                *** To see Scheduler running and all the other elements of control plane run the command ***
                    (get all pods from kube-system)

kubectl get pods -n kube-system

                *** to get more details on  get pods***

kubectl get pods -o wide

                *** ***

To get pods by label value:
        kubectl get pods -l <Label_name>=<label_value>

                *** Get all objects by label (All, like replicasets, pods, and so on)***

kubectl get all -l env=prod

                *** Find pods with several labels ***

kubectl get pods -l bu=finance,tier=frontend,env=prod

                 *** Command to taint a node ***
kubectl taint nodes <node-name> key=<Value>:<Effect>

                            value → It’s just a label-like value for the taint key, meaningful only to you

                                Effects:
                            NoSchedule – new Pods will not be scheduled
                            PreferNoSchedule – avoid scheduling if possible
                            NoExecute – evict existing Pods + block new ones

                            *** To label nodes (For nodes selectors for example) ***

kubectl label nodes <node-name> <label-key>=<label-value>

                            *** grep case-insensitive ***

                            Add:

                            -i

kubectl describe node node01 | grep -i Label

                            *** for DaemonSets use "ds", full "DaemonSet" gives errors ***

kubectl describe ds kube-proxy -n=kube-system


                            *** Command option when creating pods ***

kubectl run static-bysybox --image=busybox --restart=Never --dry-run=client -o yaml --command -- sleep 1000 > static-busybox.yaml

                            *** To ssh to a specific node **

Get node InternalIP address by running

kubctl get nodes -o wide

when

ssh <INTERNAL_IP>

                             *** You can run command to see pod status in a real time***

kubectl get pods --watch


                            *** To list priority classes ***

kubectl get priorityclass

                            *** See all events (For example to see pod scheduled event) ***

kubectl get events -o wide

                            *** To see logs of a pod ***

kubectl logs <pod name>

                            *** View metrics ***

                            To see top nodes that consumes the most CPU and memory (Metric server needs to be installed) :
kubectl top node

                            The same but for pod :

kubectl top pod

                            To see the logs of pod :

kubectl logs -f <POD NAME>        ( -f   for live logs)

    Note :
        If there are more than one container in pod you must specify the name of the container in the command:

kubectl logs -f <POD NAME> <CONTAINER NAME>


                            APPLICATION LIFECYCLE MANAGEMENT

                        Status of rollout of deployment

kubectl rollout status <DEPLOYMENT NAME>

                        History of rollouts

kubectl rollout history <DEPLOYMENT NAME>










